<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DORA</title>
    <!-- Dependencies: A-Frame and AR.js -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
         :root {
        --bg-dark: #3e0f36; /* Dark Purple */
        --color-neon: #c2ff3f; /* Neon Green */
      }
      
      /* 1. Ensure HTML and Body cover the entire viewport and set base colors */
      html, body {
        height: 100%;
        width: 100%;
        margin: 0; 
        padding: 0;
      }
      
      body {
        background-color: var(--bg-dark) !important;
        color: var(--color-neon) !important;
        overflow: hidden; 
        position: relative; /* Context for absolute children */
        display: block; 
      }
      
      /* --- LOGO STYLING (Fixed position for reliable overlay) --- */
      #logo-link {
        position: fixed; 
        top: 60px; 
        left: 80px; 
        z-index: 100; 
        cursor: pointer; 
      }
      #pandora-logo {
        width: 75px; 
        height: 75px;
        border: none; 
        display: block;
      }
      
      /* --- TITLE STYLING (Fixed position for reliable overlay) --- */
      #app-title {
        position: fixed; 
        top: 80px; 
        left: 50%; 
        transform: translateX(-50%); /* CRITICAL: Ensures perfect horizontal centering */
  
        font-size: 2.5em;
        margin: 0;
        line-height: 1.1;
        font-family: "Felix Titling";
        text-shadow: 2px 2px 4px #000000; 
        color: #c2ff3f;
        padding: 0;
        z-index: 50;
      }

      /* Optional: Style AR.js loading/debug elements if they appear */
      .arjs-loader, .a-loader {
        color: var(--color-neon) !important;
        background-color: var(--bg-dark) !important;
      }

      /* --- AR CONTAINER STYLING (Centered Rounded Square) --- */
      #ar-wrapper {
        /* CRITICAL: Absolute positioning with auto margins centers the square */
        position: absolute; 
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto; /* Centers the block vertically and horizontally */
        
        /* ADJUSTMENT: Reduced size from 80vh to 60vh */
        width: 60vh; 
        height: 60vh;
        max-width: 90%; 
        overflow: hidden; 
        
        /* Border and Rounded Corners */
        border: 4px solid var(--color-neon); 
        border-radius: 15px; 
        box-shadow: 0 0 20px rgba(194, 255, 63, 0.5); 
        z-index: 1; /* Place below logo/title */
      }
      
      a-scene {
        /* Ensure the scene fills the bounded wrapper */
        width: 100% !important;
        height: 100% !important;
        display: block;
      }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">
    
    <a href="index.html" id="logo-link">
        <img 
            id="pandora-logo" 
            src="logo.png" 
            alt="PANDORA Logo - Click to Visit Home" 
        />
    </a>

    <h1 id="app-title">AR Project Report</h1>
    <!-- 1. Define the A-Frame Component in the script block below -->
    
    <a-scene 
        embedded 
        <a-scene embedded arjs='sourceType: webcam;'>
    >
        <!-- 2. Attach the component (marker-redirect) to the marker -->
        <a-marker preset="hiro" marker-redirect> 
            <!-- Visual asset to confirm marker detection -->
            <a-box position='0 0.5 0' material='color: #FF69B4;' animation="property: rotation; to: 0 360 0; loop: true; dur: 2000;"></a-box>
            <a-text value="Found! Redirecting..." color="white" align="center" width="2" position="0 1.2 0" rotation="-90 0 0"></a-text>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // --- Configuration ---
        const REDIRECT_URL = "report.html";
        let isRedirecting = false; // State flag to prevent multiple redirects

        /**
         * A-FRAME COMPONENT: Listens for the 'markerFound' event on its element (the <a-marker>).
         */
        AFRAME.registerComponent('marker-redirect', {
            init: function () {
                const markerElement = this.el; // Reference to the <a-marker> element
                
                // Add the listener for when the marker is found
                markerElement.addEventListener('markerFound', function() {
                    if (isRedirecting) return; // Stop if already redirected
                    
                    isRedirecting = true;
                    console.log("Marker Found! Redirecting to: " + REDIRECT_URL);
                    
                    // Use a slight delay for better user experience/visibility of the confirmation
                    setTimeout(() => {
                        window.location.href = REDIRECT_URL; // Redirects the current page
                    }, 1000); 
                });
                
                // Optional: Listen for marker lost (uncomment if you need to reset the state)
                markerElement.addEventListener('markerLost', function() {
                    // isRedirecting = false;
                });
            }
        });
    </script>
</body>
</html>